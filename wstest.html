<html>
	<head>
		<title>Websocket Test</title>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
		<script language="javascript" type="text/javascript">
			$(function() {
					var conn;
					var msg = $("#msg");
					var log = $("#log");
					var loginarea = $("#loginbox");
					var chatarea = $("#chatarea");
					var inpBox = $("#textIn");

					function appendLog(msg) {
					log.append("<p class='msg'>" + msg + "</p>")
					}

					$("#login").click(function() {
						conn.send($("#host").val());
						conn.send($("#username").val());
						conn.send($("#password").val());
						loginarea.hide(500);
						chatarea.show(500);
						chatarea.css('background','green');
						});

					$("#form").submit(function() {
							if (!conn) {
							return false;
							}
							if (!msg.val()) {
							return false;
							}
							conn.send(msg.val());
							msg.val("");
							return false
							});

					$("#textIn").keyup(function(event){
							if(event.keyCode == 13) {
							tb = $("#textIn")
							conn.send(tb.val())
							tb.val("")
							}
							});
					if (window["WebSocket"]) {
						loginarea.css('height', '300px');
						chatarea.hide();

						conn = new WebSocket("ws://127.0.0.1:8080/ws");
						conn.onclose = function(evt) {
							appendLog("<p><b>Connection closed.</b></p>")
						};
						conn.onmessage = function(evt) {
							appendLog(evt.data)
						};
					} else {
						appendLog($("<p><b>Your browser does not support WebSockets.</b></p>"))
					}
			});

</script>
<style media="screen" type="text/css">
	#loginbox {
		border:2px solid black;
		overflow: hidden;
		width: 960px;
		margin-left: auto;
		margin-right: auto;
	}

	#chatarea {
		border:2px solid black;
		width: 960px;
		margin-left: auto;
		margin-right: auto;
		overflow: hidden;
	}
</style>
	</head>
	<body>
		<h2>WebSocket Test</h2> 
		<div id="loginbox">
			<input type="text" id="host" /><br>
			<input type="text" id="username" /><br>
			<input type="password" id="password" /><br>
			<input type="button" id="login" value="Login" />
		</div>
		<div id="chatarea">
			<div id="log"></div>
			<input type="text" id="textIn" />
		</div>
	</body>
</html>
